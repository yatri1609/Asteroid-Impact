monthly_transaction_value <- data %>%
group_by(Month) %>%
summarise(TotalValue = sum(value, na.rm = TRUE))
View(senator_investments_df)
data$Month <- floor_date(data$txDate, "month")
monthly_transaction_value <- data %>%
group_by(Month) %>%
summarise(TotalValue = sum(Value, na.rm = TRUE))
monthly_transaction_value <- data %>%
group_by(Month) %>%
summarise(TotalValue = sum(value, na.rm = TRUE))
monthly_transaction_value <- data %>%
group_by(Month) %>%
summarise(TotalValue = sum(value))
data <-senator_investment_df
data <-senator_investments_df
# Convert the transaction date to a Date object
data$txDate <- as.Date(data$txDate, "%Y-%m-%d")
# Filter out rows with NA in txDate if any
data <- na.omit(data)
data$Month <- floor_date(data$txDate, "month")
monthly_transaction_size <- data %>%
group_by(Month) %>%
summarise(TotalValue = sum(size, na.rm = TRUE))
monthly_transaction_size <- data %>%
group_by(Month) %>%
summarise(TotalSize = sum(size, na.rm = TRUE))
data$size <- as.numeric(as.character(data$size))
monthly_transaction_size <- data %>%
group_by(Month) %>%
summarise(TotalSize = sum(size, na.rm = TRUE))
ggplot(monthly_transaction_size, aes(x = Month, y = TotalSize)) +
geom_line() +
geom_point() +
scale_x_date(date_breaks = "1 month", date_labels = "%b %Y") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(title = "Monthly Total Transaction Size of Senators",
x = "Date",
y = "Total Transaction Size")
data$size <- as.numeric(as.character(data$value))
data <-senator_investments_df
# Convert the transaction date to a Date object
data$txDate <- as.Date(data$txDate, "%Y-%m-%d")
# Filter out rows with NA in txDate if any
data <- na.omit(data)
data$Month <- floor_date(data$txDate, "month")
data$value <- as.numeric(as.character(data$value))
monthly_transaction_value <- data %>%
group_by(Month) %>%
summarise(TotalValue = sum(value, na.rm = TRUE))
ggplot(monthly_transaction_value, aes(x = Month, y = TotalValue)) +
geom_line() +
geom_point() +
scale_x_date(date_breaks = "1 month", date_labels = "%b %Y") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(title = "Monthly Total Transaction Value of Senators",
x = "Date",
y = "Total Transaction Value")
ggplot(monthly_transaction_value, aes(x = Month, y = TotalValue)) +
geom_line() +
geom_point() +
scale_x_date(date_breaks = "1 month", date_labels = "%b %Y") +
scale_y_continuous(labels = scales::comma) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(title = "Monthly Total Transaction Value of Senators",
x = "Date",
y = "Total Transaction Value")
# Count the number of buy vs. sell transactions
buy_sell_counts <- table(data$txType)
# Pie chart
pie(buy_sell_counts, main = "Buy vs. Sell Transactions")
# Aggregate transactions by sector
sector_counts <- table(data$issuer.sector)
# Bar plot
barplot(sector_counts, main = "Transactions by Sector", col = rainbow(length(sector_counts)), las = 2, cex.names = 0.8)
# Bar plot
barplot(sector_counts, main = "Transactions by Sector", col = rainbow(length(sector_counts)))
# Bar plot
barplot(sector_counts, main = "Transactions by Sector", col = rainbow(length(sector_counts)), las = 2, cex.names = 0.5)
# Bar plot
barplot(sector_counts, main = "Transactions by Sector", col = rainbow(length(sector_counts)), las = 10, cex.names = 0.5)
# Bar plot
barplot(sector_counts, main = "Transactions by Sector", col = rainbow(length(sector_counts)), las = 2, cex.names = 1)
# Aggregate transactions by state
state_counts <- table(data$politician._stateId)
# Bar plot
barplot(state_counts, main = "State Representation in Transactions", col = rainbow(length(state_counts)), las = 2, cex.names = 0.8)
install.packages("treemap")
library(treemap)
value_sector <- data %>%
group_by(issuer.sector) %>%
summarise(TotalValue = sum(value, na.rm = TRUE))
treemap(value_sector,
index="sector",
vSize="value",
title="Sector Distribution",
fontsize.labels=12,
palette="lightblue")
treemap(value_sector,
index="issuer.sector",
vSize="TotalValue",
title="Sector Distribution",
fontsize.labels=12,
palette="lightblue")
install.packages("RColorBrewer")
knitr::opts_chunk$set(echo = TRUE)
color_palette <- brewer.pal(n = min(length(value_sector$issuer.sector), 9), name = "Blues")  # Change 'Blues' to any palette you like
library(RColorBrewer)
color_palette <- brewer.pal(n = min(length(value_sector$issuer.sector), 9), name = "Blues")  # Change 'Blues' to any palette you like
treemap(value_sector,
index="issuer.sector",
vSize="TotalValue",
title="Sector Distribution",
fontsize.labels=12,
palette=color_palette)
# Create the treemap with hex color values
treemap(value_sector,
index = "issuer.sector",
vSize = "TotalValue",
vColor = "TotalValue",
type="index",
palette = color_palette,  # Use the color palette defined above
title = "Sector Distribution",
fontsize.labels = 12
)
library(treemap)
# Create the treemap with hex color values
treemap(value_sector,
index = "issuer.sector",
vSize = "TotalValue",
vColor = "TotalValue",
type="index",
palette = color_palette,  # Use the color palette defined above
title = "Sector Distribution",
fontsize.labels = 12
)
# Create the treemap with hex color values
treemap(value_sector,
index = "issuer.sector",
vSize = "TotalValue",
vColor = "TotalValue",
palette = color_palette,  # Use the color palette defined above
title = "Sector Distribution",
fontsize.labels = 12
)
# Create the treemap with hex color values
treemap(value_sector,
index = "issuer.sector",
vSize = "TotalValue",
vColor = "TotalValue",
type="index",
palette = color_palette,  # Use the color palette defined above
title = "Sector Distribution",
fontsize.labels = 10
)
treemap(value_sector,
index = "issuer.sector)",
vSize = "TotalValue",
title = "Sector Distribution",
fontsize.labels = 12,
fontcolor.labels = "white",
fontface.labels = 2,
bg.labels = "transparent",
align.labels = list(
c("center", "center"),
c("center", "center")
),
overlap.labels = 0.5,
inflate.labels = F
)
# Now create the treemap
treemap(value_sector,
index = "issuer.sector",
vSize = "TotalValue",
title = "Sector Distribution",
fontsize.labels = 12,
fontcolor.labels = "white",
fontface.labels = 2,
bg.labels = "transparent",
align.labels = list(
c("center", "center"),
c("center", "center")
),
overlap.labels = 0.5,
inflate.labels = F
)
# Now create the treemap
treemap(value_sector,
index = "issuer.sector",
vSize = "TotalValue",
title = "Sector Distribution",
fontsize.labels = 12,
fontcolor.labels = "white",
fontface.labels = 2,
bg.labels = "transparent",
align.labels = list(
c("center", "center"),
c("center", "center")
),
palette = color_palette,  # Use the color palette defined above
overlap.labels = 0.5,
inflate.labels = F
)
# Create the treemap with hex color values
treemap(value_sector,
index = "issuer.sector",
vSize = "TotalValue",
vColor = "TotalValue",
type="index",
palette = color_palette,  # Use the color palette defined above
title = "Sector Distribution",
fontsize.labels = 10
)
data <-senator_investments_df
# Convert the transaction date to a Date object
data$txDate <- as.Date(data$txDate, "%Y-%m-%d")
data$Month <- floor_date(data$txDate, "month")
data$Month <- FLOOR_DATE(data$txDate, "month")
data$Month <- floor_date(data$txDate, "month")
data$value <- as.numeric(as.character(data$value))
monthly_transaction_value <- data %>%
group_by(Month) %>%
summarise(TotalValue = sum(value, na.rm = TRUE))
#visualization
library(dplyr)
data <-senator_investments_df
# Convert the transaction date to a Date object
data$txDate <- as.Date(data$txDate, "%Y-%m-%d")
data$Month <- floor_date(data$txDate, "month")
library(tidyverse)
library(tidyquant)
library(PerformanceAnalytics)
library(xts)
library(lubridate)
library(Quandl)
library(riingo)
library(httr)
library(tidyr)
library(dplyr)
library(jsonlite)
library(httr)
library(purrr)
library(dplyr)
data <-senator_investments_df
# Convert the transaction date to a Date object
data$txDate <- as.Date(data$txDate, "%Y-%m-%d")
data$Month <- floor_date(data$txDate, "month")
data$value <- as.numeric(as.character(data$value))
monthly_transaction_value <- data %>%
group_by(Month) %>%
summarise(TotalValue = sum(value, na.rm = TRUE))
ggplot(monthly_transaction_value, aes(x = Month, y = TotalValue)) +
geom_line() +
geom_point() +
scale_x_date(date_breaks = "1 month", date_labels = "%b %Y") +
scale_y_continuous(labels = scales::comma) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(title = "Monthly Total Transaction Value of Senators",
x = "Date",
y = "Total Transaction Value")
monthly_transaction_value <- data %>%
mutate(AdjustedValue = if_else(txType == "sell", -value, value)) %>%
group_by(Month) %>%
summarise(TotalValue = sum(AdjustedValue, na.rm = TRUE))
ggplot(monthly_transaction_value, aes(x = Month, y = TotalValue)) +
geom_line() +
geom_point() +
scale_x_date(date_breaks = "1 month", date_labels = "%b %Y") +
scale_y_continuous(labels = scales::comma) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(title = "Monthly Total Transaction Value of Senators",
x = "Date",
y = "Total Transaction Value")
library(httr)
library(jsonlite)
library(dplyr)
library(ggplot2)
library(plotly)
## GET LAP DATA
response_16 <- GET('https://api.openf1.org/v1/laps?session_key=latest&driver_number=16')
parsed_data_16 <- fromJSON(content(response_16, 'text'))
print(parsed_data_16)
#filter out mini-sector speeds
df_filtered_16 <- subset(parsed_data_16, select = -c(segments_sector_1,
segments_sector_2,
segments_sector_3))
head(df_filtered_16)
ggplot(df_filtered_16, aes(x=lap_number, y=lap_duration)) +
geom_line() +
geom_point() +
theme_minimal() +
labs(title="Lap Duration Over Laps", x="Lap Number", y="Lap Duration (seconds)")
## GET STINT DATA
stint_response <- GET('https://api.openf1.org/v1/stints?session_key=latest&driver_number=16')
stint_parsed_data <- fromJSON(content(stint_response, 'text'))
head(stint_parsed_data)
# Mapping compounds to colors
compound_colors <- setNames(c("orange", "red", "green"), c("MEDIUM", "SOFT", "HARD"))
# Assign colors based on compound in stint data
stint_parsed_data$color <- compound_colors[stint_parsed_data$compound]
# Function to get tire color for each lap
get_tire_color_for_lap <- function(lap_number) {
for (i in 1:nrow(stint_parsed_data)) {
if (lap_number >= stint_parsed_data$lap_start[i] && lap_number <= stint_parsed_data$lap_end[i]) {
return(stint_parsed_data$color[i])
}
}
return(NA) # Return NA if no stint matches
}
# Apply function to each lap in lap_data
df_filtered_16$tire_color <- sapply(df_filtered_16$lap_number, get_tire_color_for_lap)
# Plotting
ggplot(df_filtered_16, aes(x = lap_number, y = lap_duration, color = tire_color, group = 1)) +
geom_line() +
geom_point() +
scale_color_identity() + # Use the actual colors specified in the data
theme_minimal() +
labs(title = "Lap Duration Over Laps by Tire Compound",
x = "Lap Number",
y = "Lap Duration (seconds)",
color = "Tire Compound")
# Convert the colors to a more descriptive label for the legend
df_filtered_16$tire_type <- ifelse(df_filtered_16$tire_color == "orange", "MEDIUM",
ifelse(df_filtered_16$tire_color == "red", "SOFT", "HARD"))
# Plotting with Plotly
fig <- plot_ly(data = df_filtered_16, x = ~lap_number, y = ~lap_duration, type = 'scatter', mode = 'lines+markers',
color = ~tire_type, colors = c('MEDIUM' = 'orange', 'SOFT' = 'red', 'HARD' = 'green'),
marker = list(size = 10))
fig <- fig %>% layout(title = 'Lap Duration Over Laps by Tire Compound',
xaxis = list(title = 'Lap Number'),
yaxis = list(title = 'Lap Duration (seconds)'),
legend = list(title = list(text = 'Tire Compound')))
# Show plot
fig
# carlos
## GET LAP DATA
response_55 <- GET('https://api.openf1.org/v1/laps?session_key=latest&driver_number=55')
parsed_data_55 <- fromJSON(content(response_55, 'text'))
print(parsed_data_55)
#filter out mini-sector speeds
df_filtered_55 <- subset(parsed_data_55, select = -c(segments_sector_1,
segments_sector_2,
segments_sector_3))
head(df_filtered_55)
ggplot(df_filtered_55, aes(x=lap_number, y=lap_duration)) +
geom_line() +
geom_point() +
theme_minimal() +
labs(title="Lap Duration Over Laps", x="Lap Number", y="Lap Duration (seconds)")
## GET STINT DATA
stint_response_55 <- GET('https://api.openf1.org/v1/stints?session_key=latest&driver_number=55')
stint_parsed_data_55 <- fromJSON(content(stint_response_55, 'text'))
head(stint_parsed_data_55)
# Mapping compounds to colors
compound_colors <- setNames(c("orange", "red", "green"), c("MEDIUM", "SOFT", "HARD"))
# Assign colors based on compound in stint data
stint_parsed_data_55$color <- compound_colors[stint_parsed_data_55$compound]
# Function to get tire color for each lap
get_tire_color_for_lap <- function(lap_number) {
for (i in 1:nrow(stint_parsed_data_55)) {
if (lap_number >= stint_parsed_data_55$lap_start[i] && lap_number <= stint_parsed_data_55$lap_end[i]) {
return(stint_parsed_data_55$color[i])
}
}
return(NA) # Return NA if no stint matches
}
# Apply function to each lap in lap_data
df_filtered_55$tire_color <- sapply(df_filtered_55$lap_number, get_tire_color_for_lap)
# Plotting
ggplot(df_filtered_55, aes(x = lap_number, y = lap_duration, color = tire_color, group = 1)) +
geom_line() +
geom_point() +
scale_color_identity() + # Use the actual colors specified in the data
theme_minimal() +
labs(title = "Lap Duration Over Laps by Tire Compound",
x = "Lap Number",
y = "Lap Duration (seconds)",
color = "Tire Compound")
# Convert the colors to a more descriptive label for the legend
df_filtered_55$tire_type <- ifelse(df_filtered_55$tire_color == "orange", "MEDIUM",
ifelse(df_filtered_55$tire_color == "red", "SOFT", "HARD"))
# Plotting with Plotly
df_filtered_16$name_tire <- paste(df_filtered_16$tire_type, '- Leclerc')
df_filtered_55$name_tire <- paste(df_filtered_55$tire_type, '- Sainz')
# Plotting with Plotly, adding two traces
fig <- plot_ly()
# Adding dataset 1 with a specific style
fig <- fig %>% add_trace(data = df_filtered_16, x = ~lap_number, y = ~lap_duration, type = 'scatter', mode = 'lines+markers',
color = ~tire_type, colors = c('MEDIUM' = 'orange', 'SOFT' = 'red', 'HARD' = 'green'),
marker = list(size = 10), line = list(dash = 'solid'),
name = ~name_tire)
# Adding dataset 2 with a different style
fig <- fig %>% add_trace(data = df_filtered_55, x = ~lap_number, y = ~lap_duration, type = 'scatter', mode = 'lines+markers',
color = ~tire_type, colors = c('MEDIUM' = 'orange4', 'SOFT' = 'red4', 'HARD' = 'green4'),
marker = list(size = 10, symbol = 'square'), line = list(dash = 'dot'),
name = ~name_tire)
# Adjusting the layout
fig <- fig %>% layout(title = 'Lap Duration Over Laps by Tire Compound',
xaxis = list(title = 'Lap Number'),
yaxis = list(title = 'Lap Duration (seconds)'),
legend = list(title = list(text = 'Tire Compound')))
# Show plot
fig
setwd("C:/Users/itsme/OneDrive/Desktop/Personal Projects/Asteroid-Impact")
library(dplyr)
library(tidyr)
library(tidyverse)
library(ggplot2)
library(plotly)
library(corrplot)
library(webshot)
#import processed files
data_impacts <- read.csv("./Data/processed_impacts.csv", header=TRUE)
data_orbits <- read.csv("./Data/processed_orbits.csv", header=TRUE)
str(data_impacts)
head(data_impacts)
str(data_orbits)
head(data_orbits)
##### Asteroid features by object name #####
data_impacts_long <- data_impacts %>%
mutate("Asteroid.Diameter..km.*100" = Asteroid.Diameter..km.*100) %>%
select(Object.Name,"Asteroid.Diameter..km.*100",Asteroid.Magnitude,Asteroid.Velocity) %>%
pivot_longer(cols = -Object.Name, names_to = "Metric", values_to = "Value")
AsteroidFeaturesByObject <- plot_ly(data_impacts_long, x = ~Value, y = ~reorder(Object.Name, Value),
color = ~Metric, type = 'bar', orientation = 'h') %>%
layout(yaxis = list(title = 'Asteroids'),
xaxis = list(title = 'Metrics'),
barmode = 'stack',
title = 'Asteroid features by Object',
legend = list(title = list(text = 'Metric')))
AsteroidFeaturesByObject
##### Asteroid Impact Risk by Year #####
asteroid_counts <- data_impacts %>%
group_by(Period.End) %>%
summarise(count = n())
# Plot the stacked bar chart
plot_ly(asteroid_counts, x = ~Period.End, y = ~count, type = 'bar',
colors = blues9) %>%
layout(title = 'Asteroid Impact Risk by Year',
xaxis = list(title = 'Year'),
yaxis = list(title = 'Count of Asteroids'),
colorway = RColorBrewer::brewer.pal(8, "Set2"))
##### Average Cumulative Impact Probability by Period Start #####
average_impact <- data_impacts %>%
group_by(Period.Start) %>%
summarise(Average_Cumulative_Impact_Probability = mean(Cumulative.Impact.Probability, na.rm = TRUE))
plot_ly(average_impact, x = ~Period.Start, y = ~Average_Cumulative_Impact_Probability,
type = 'scatter', mode = 'lines+markers') %>%
layout(title = "Average Cumulative Impact Probability by Year",
xaxis = list(title = "Year"),
yaxis = list(title = "Average Cumulative Impact Probability"))
##### Possible Impacts vs Asteroid features #####
plot_ly(data_impacts, x=~Asteroid.Velocity, y=~Possible.Impacts,
type='scatter', mode='markers') %>%
layout(title = "Possible Impacts by Asteroid Velocity",
xaxis = list(title = "Asteroid Velocity in km/s"),
yaxis = list(title = "Possible Impacts"))
plot_ly(data_impacts, x=~Asteroid.Magnitude, y=~Possible.Impacts,
type='scatter', mode='markers') %>%
layout(title = "Possible Impacts by Asteroid Magnitude",
xaxis = list(title = "Asteroid Magnitude"),
yaxis = list(title = "Possible Impacts"))
plot_ly(data_impacts, x=~Asteroid.Diameter..km., y=~Possible.Impacts,
type='scatter', mode='markers') %>%
layout(title = "Possible Impacts by Asteroid Diameter",
xaxis = list(title = "Asteroid Diameter in km"),
yaxis = list(title = "Possible Impacts"))
##### Orbit data classification
asteroid_category_count <- data_orbits %>%
group_by(Object.Classification) %>%
summarise(count = n())
plot_ly(asteroid_category_count, x=~Object.Classification, y=~count, type='bar') %>%
layout(title = "Asteroids per Classification",
xaxis = list(title = "Asteroid Classification"),
yaxis = list(title = "Number of Asteroids"))
result_merged_data <- merge(data_impacts, data_orbits, by = "Object.Name", all = TRUE)
View(result_merged_data)
result_merged_data <- left_join(data_impacts, data_orbits, by = "Object.Name")
View(result_merged_data)
View(result_merged_data)
unique(data_impacts$Object.Name)
df1$InDf2 <- (data_impacts$Object.Name) %in% (data_orbits$Object.Name)
InDf2 <- (data_impacts$Object.Name) %in% (data_orbits$Object.Name)
InDf2
View(data_orbits)
View(data_impacts)
View(data_orbits)
View(data_impacts)
View(data_impacts)
View(data_impacts)
cor(select(data_orbits, -Object.Name))
View(data_orbits)
unique(data_orbits$Object.Classification)
asteroid_category_count <- data_orbits %>%
group_by(Object.Classification) %>%
summarise(count = n()) %>%
mutate(color = ifelse(grepl("Hazard", Object.Classification), "red", "blue"))
plot_ly(asteroid_category_count, x=~Object.Classification, y=~count,
type='bar', marker=list(color=~color)) %>%
layout(title = "Asteroids per Classification",
xaxis = list(title = "Asteroid Classification"),
yaxis = list(title = "Number of Asteroids"))
asteroid_category_count <- data_orbits %>%
group_by(Object.Classification) %>%
summarise(count = n()) %>%
mutate(color = ifelse(grepl("Hazard", Object.Classification), "red", "lightblue"))
plot_ly(asteroid_category_count, x=~Object.Classification, y=~count,
type='bar', marker=list(color=~color)) %>%
layout(title = "Asteroids per Classification",
xaxis = list(title = "Asteroid Classification"),
yaxis = list(title = "Number of Asteroids"))
View(data_orbits)
